<!DOCTYPE html>
<html lang="zh">
 <head> 
  <meta charset="utf-8" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" /> 
  <title>AVsearch</title> 
  <link rel="icon" href="/static/favicon.ico" type="image/ico" /> 
  <meta name="keywords" content="凌星阁,红队作战平台" /> 
  <meta name="author" content="Lintstar" /> 
  <link href="static/css/bootstrap.min.css" rel="stylesheet" /> 
  <link href="static/css/materialdesignicons.min.css" rel="stylesheet" /> 
  <link href="static/css/style.min.css" rel="stylesheet" /> 
 </head> 
 <body> 
  <div class="container-fluid p-t-15"> 
   <div class="row"> 
    <div class="col-md-12 col-lg-12"> 
     <div class="card"> 
      <div class="card-header bg-primary"> 
       <h3> AV 检测 </h3>
       <ul class="card-actions"> 
       </ul> 
      </div> 
      <div class="card-body">
        <div class="container mt-3">
        <center >
          <h2>Windows Antivirus Filter</h2>
          <h4>tasklist /svc</h4><br>
          <textarea class="border border-primary" style="width: 950px; height: 341px;" id="content" placeholder="
      C:\Users\Someone\Desktop>tasklist /svc
      ----- 复制返回内容到输入框 -----
          "></textarea><br><br>
          <input class="btn btn-cyan btn-w-md" type="submit" id="search" value="查询" onclick="getAVName();"><br><br>
        </center>

        <script src="static/js/tools/avlist.js"></script>

        <script>
        function getAVName(){
            var tasklist = document.getElementById('content').value;
            var re = new RegExp("(.*?)\.exe", "g");
            var tasks = tasklist.match(re);
            var result = document.getElementById('result');
            var htmlContent = "";
            for(i=0; i<Object.keys(avList).length; i++){
               var taskid = Object.keys(avList)[i];
               for(x=0; x<tasks.length; x++){
                 if(taskid == tasks[x]){
                  htmlContent += taskid + " <=> " + avList[taskid] + "<br>";
                 }
               }
            }
            result.innerHTML = htmlContent;
        }
        </script> 
        </div>
       </div> 
      </div> 
     </div> 
    </div> 
    <!-- .col-sm-6 --> 
    <div class="card"> 
      <div class="card-body">
        <center>
          <h4> 检测结果 </h4>
          <h6><div  id="result"></div></h6>          
        </center>
      </div>
    </div>

   </div> 
   <!-- .row --> 
   <!-- End Cards with Actions --> 
  </div> 
  <script type="text/javascript" src="static/js/jquery.min.js"></script> 
  <script type="text/javascript" src="static/js/bootstrap.min.js"></script> 
  <script type="text/javascript" src="static/js/main.min.js"></script>  
 </body>
</html>
